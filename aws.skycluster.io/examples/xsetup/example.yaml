apiVersion: aws.skycluster.io/v1alpha1
kind: XSetup
metadata:
  name: aws-us-east-1
  labels:
    skycluster.io/managed-by: "skycluster"
    skycluster.io/provider-platform: aws
    skycluster.io/provider-region: us-east-1
    skycluster.io/provider-zone: us-east-1a
spec:
  vpcCidr: 10.20.30.0/16
  publicKey: |
    ssh-rsa AAAAB3NzaC1yc2EAAAABIwAAAQEArD1z...
  gateway:
    image: ami-12345678
    flavor: t3.nano
    volumeType: gp2
    volumeSize: 20
    userData : |
      #!/bin/bash
      echo "Initializing gateway..."
  # Subnet CIDRs should be within the VPC CIDR range
  # Subnets are used for services and resources provisioned in the VPC
  # They also used for Pod and service network in GKE

  # Note: AWS EKS uses at least two subnets for pod networks
  # Since we need to have a single pod cidr for sumariner setup,
  # a manual configuration needed.
  # We reserve half of the VPC subnet for EKS and create custom subnets
  # to be able to manage the cidr. We let the rest of the vpc vidr for the user.
  subnets:
    - type: public
      zone: us-east-1a
      cidr: 10.20.30.0/24
    - type: private
      zone: us-east-1b
      cidr: 10.20.31.0/24 
  providerRef:
    platform: aws
    region: us-east-1
    zones: 
      primary: us-east-1a
      secondary: us-east-1b
#     name: example-provider
status:
  log: "Setup created successfully."
  keypair:
    name: example-keypair
    id: example-keypair-id
  vpc:
    id: vpc-12345678
    cidrBlock: "10.20.30.0/16"
  subnets:
    - type: public
      id: subnet-12345678
      cidrBlock: "10.20.30.0/24"
  gateway:
    publicIp: "<public-ip>"
    privateIp: "<private-ip>"